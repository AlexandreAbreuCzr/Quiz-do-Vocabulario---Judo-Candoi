const palavrasPorGrupo = {
    1: [
        { palavra: 'ARIGATÔ-GOZAIMASSU', resposta: 'Obrigado' },
        { palavra: 'AGURA', resposta: 'Posição sentado como índio' },
        { palavra: 'ASHI', resposta: 'Pé, perna' },
        { palavra: 'AYUMI-ASHI', resposta: 'Passo normal' },
        { palavra: 'DAN', resposta: 'Grau, Graduação' },
        { palavra: 'DANGAI', resposta: 'Grupo antes da preta' },
        { palavra: 'DÔ', resposta: 'Caminho' },
        { palavra: 'DOJÔ', resposta: 'Academia, local de treinamento' },
        { palavra: 'DÔO-HAI', resposta: 'Colegas' },
        { palavra: 'ERI', resposta: 'Gola' }
    ],
    2: [
        { palavra: 'GATAME', resposta: 'Ação de segurar' },
        { palavra: 'GÔMEM', resposta: 'Perdão, desculpa' },
        { palavra: 'HAJIMÊ', resposta: 'Iniciar, começar' },
        { palavra: 'HANSSÔKU-MAKE', resposta: 'Desclassificação' },
        { palavra: 'HARA', resposta: 'Estômago' },
        { palavra: 'HAY', resposta: 'Sim, pronto' },
        { palavra: 'HIDARI', resposta: 'Esquerda' },
        { palavra: 'HIDARI-JIGÔ-TAI', resposta: 'Posição de defesa esquerda' },
        { palavra: 'HIDARI-KUMI', resposta: 'Pegada de esquerda' },
        { palavra: 'HIDARI-SHIZENTAI', resposta: 'Posição natural esquerda' }
    ],
    3: [
        { palavra: 'HIKI-WAKE', resposta: 'Empate' },
        { palavra: 'HIZA', resposta: 'Joelho' },
        { palavra: 'IPPON', resposta: 'Cem pontos' },
        { palavra: 'JIGÔ-HONTAI', resposta: 'Posição/defesa fundamental' },
        { palavra: 'JIGORO KANO', resposta: 'Nome do fundador do JUDÔ' },
        { palavra: 'JIGÔ-TAI', resposta: 'Posição de defesa' },
        { palavra: 'JU', resposta: 'Suave' },
        { palavra: 'JUDÔ', resposta: 'Caminho da Suavidade/Flexibilidade' },
        { palavra: 'JUDOCA', resposta: 'Aquele que pratica o JUDÔ' },
        { palavra: 'JUDOGUI', resposta: 'Roupa para a prática do JUDÔ' }
    ],
    4: [
        { palavra: 'KAESHI-WAZA', resposta: 'Técnicas de contragolpes' },
        { palavra: 'KAKÊ', resposta: 'Execução, finalização' },
        { palavra: 'KAMI', resposta: 'Acima' },
        { palavra: 'KATAME', resposta: 'Controle' },
        { palavra: 'KENKA-YOTSU', resposta: 'Pegada contrária' },
        { palavra: 'KESA', resposta: 'Ângulo' },
        { palavra: 'KIAI', resposta: 'União do espírito, grito de competição' },
        { palavra: 'KO', resposta: 'Pequeno' },
        { palavra: 'KODOKAN', resposta: 'Escola onde se estuda o caminho' }
    ],
    5: [
        { palavra: 'KÔ-HAI', resposta: 'Colega menos graduado' },
        { palavra: 'KON-BAN-WA', resposta: 'Boa Noite' },
        { palavra: 'KON-NITI-WA', resposta: 'Boa tarde' },
        { palavra: 'KOSHI', resposta: 'Quadril' },
        { palavra: 'KUMI-KATA', resposta: 'Maneira de segurar, pegada' },
        { palavra: 'KUZUSHI', resposta: 'Desequilíbrio' },
        { palavra: 'KYOTSUKE', resposta: 'Atenção' },
        { palavra: 'MATÊ', resposta: 'Parar' },
        { palavra: 'MIGUI', resposta: 'Direita' },
        { palavra: 'MIGUI-JIGÔ-TAI', resposta: 'Posição de defesa direita' }
    ],
    6: [
        { palavra: 'MIGUI-KUMI', resposta: 'Pegada de direita' },
        { palavra: 'MIGUI-SHIZENTAI', resposta: 'Posição natural direita' },
        { palavra: 'MOKUSSÔ', resposta: 'Meditação' },
        { palavra: 'MORO-TE', resposta: 'Com as duas mãos' },
        { palavra: 'NAGUE-AI', resposta: 'Treinamento de projeção' },
        { palavra: 'Ô', resposta: 'Grande' },
        { palavra: 'OBI', resposta: 'Faixa' },
        { palavra: 'OHAYÔ-GOZAIMASSU', resposta: 'Bom dia' },
        { palavra: 'ONEGAI-SHIMASSU', resposta: 'Por favor' },
        { palavra: 'OSSAE-KOMI', resposta: 'Imobilização' }
    ],
    7: [
        { palavra: 'OYASUMI-NASSAI', resposta: 'Boa noite (despedida)' },
        { palavra: 'RANDORI', resposta: 'Treinamento livre' },
        { palavra: 'REI', resposta: 'Cumprimento ou saudação' },
        { palavra: 'REI-HÔ', resposta: 'Formas de cumprimento/saudação' },
        { palavra: 'RENRAKU-HENKA-WAZA', resposta: 'Técnicas em sequência' },
        { palavra: 'RITSU-I', resposta: 'Posição em pé' },
        { palavra: 'RITSU-REI', resposta: 'Saudação em pé' },
        { palavra: 'SAYÔNARA', resposta: 'Até logo' },
        { palavra: 'SEI-ZÁ', resposta: 'Posição ajoelhado' },
        { palavra: 'SEMPAI', resposta: 'Colega mais graduado' }
    ],
    8: [
        { palavra: 'SENSEI', resposta: 'Professor' },
        { palavra: 'SHIAI', resposta: 'Competição' },
        { palavra: 'SHIAI-GUEIKÔ', resposta: 'Treinamento de luta' },
        { palavra: 'SHIAI-JÔ', resposta: 'Área de competição' },
        { palavra: 'SHIDÔ', resposta: 'Penalidade = Cartão Amarelo' },
        { palavra: 'SHI-HAN', resposta: 'Mestre' },
        { palavra: 'SHINTAI', resposta: 'Formas de movimentação' },
        { palavra: 'SHISSEI', resposta: 'Postura' },
        { palavra: 'SHITABAKI OU ZUBON', resposta: 'Calça, parte inferior' },
        { palavra: 'SHIZEN-HONTAI', resposta: 'Posição natural' }
    ],
    9: [
        { palavra: 'SHIZEN-TAI', resposta: 'Posição natural' },
        { palavra: 'SONO-MAMA', resposta: 'Parar do jeito que está' },
        { palavra: 'SOREMADÊ', resposta: 'Terminar, acabar' },
        { palavra: 'SURI-ASHI', resposta: 'Passo arrastado (sem tirar os pés do chão)' },
        { palavra: 'TAIKAI', resposta: 'Campeonato' },
        { palavra: 'TAI-SABAKI', resposta: 'Movimento de esquiva' },
        { palavra: 'TATÂMI', resposta: 'Acolchoado próprio para o JUDÔ' },
        { palavra: 'TATE', resposta: 'Levantar' },
        { palavra: 'TÊ', resposta: 'Mão, braço' },
        { palavra: 'TÊ-UKEMI', resposta: 'Treinamento de batida braço' }
    ],
    10: [
        { palavra: 'TOKETÁ', resposta: 'Imobilização desfeita' },
        { palavra: 'TORIKESHI', resposta: 'Anulação da pontuação' },
        { palavra: 'TSUGUI-ASHI', resposta: 'Passo seguido' },
        { palavra: 'TSUKURI', resposta: 'Preparo do golpe' },
        { palavra: 'UKEMI', resposta: 'Amortecimento de queda ou queda' },
        { palavra: 'USHIRO', resposta: 'Atrás' },
        { palavra: 'USHIRÔ-UKEMI', resposta: 'Queda para trás' },
        { palavra: 'WAGUI', resposta: 'Casaco, parte superior do kimono' },
        { palavra: 'WAZA', resposta: 'Técnica' },
        { palavra: 'WAZA-ARI', resposta: 'Dez pontos' },
        { palavra: 'YAKUSSOKU-GUEIKÔ', resposta: 'Treinam. combinado' },
        { palavra: 'YOKO', resposta: 'Lado' },
        { palavra: 'YOKO-UKEMI', resposta: 'Queda para o lado' },
        { palavra: 'YOSHI', resposta: 'Continuar' },
        { palavra: 'ZAI', resposta: 'Posição sentado' },
        { palavra: 'ZA-REI', resposta: 'Saudação ajoelhado' }
    ],
    11: [
        { palavra: 'ARIGATÔ-GOZAIMASSU', resposta: 'Obrigado' },
        { palavra: 'AGURA', resposta: 'Posição sentado como índio' },
        { palavra: 'ASHI', resposta: 'Pé, perna' },
        { palavra: 'AYUMI-ASHI', resposta: 'Passo normal' },
        { palavra: 'DAN', resposta: 'Grau, Graduação' },
        { palavra: 'DANGAI', resposta: 'Grupo antes da preta' },
        { palavra: 'DÔ', resposta: 'Caminho' },
        { palavra: 'DOJÔ', resposta: 'Academia, local de treinamento' },
        { palavra: 'DÔO-HAI', resposta: 'Colegas' },
        { palavra: 'ERI', resposta: 'Gola' },
        { palavra: 'GATAME', resposta: 'Ação de segurar' },
        { palavra: 'GÔMEM', resposta: 'Perdão, desculpa' },
        { palavra: 'HAJIMÊ', resposta: 'Iniciar, começar' },
        { palavra: 'HANSSÔKU-MAKE', resposta: 'Desclassificação' },
        { palavra: 'HARA', resposta: 'Estômago' },
        { palavra: 'HAY', resposta: 'Sim, pronto' },
        { palavra: 'HIDARI', resposta: 'Esquerda' },
        { palavra: 'HIDARI-JIGÔ-TAI', resposta: 'Posição de defesa esquerda' },
        { palavra: 'HIDARI-KUMI', resposta: 'Pegada de esquerda' },
        { palavra: 'HIDARI-SHIZENTAI', resposta: 'Posição natural esquerda' },
        { palavra: 'HIKI-WAKE', resposta: 'Empate' },
        { palavra: 'HIZA', resposta: 'Joelho' },
        { palavra: 'IPPON', resposta: 'Cem pontos' },
        { palavra: 'JIGÔ-HONTAI', resposta: 'Posição/defesa fundamental' },
        { palavra: 'JIGORO KANO', resposta: 'Nome do fundador do JUDÔ' },
        { palavra: 'JIGÔ-TAI', resposta: 'Posição de defesa' },
        { palavra: 'JU', resposta: 'Suave' },
        { palavra: 'JUDÔ', resposta: 'Caminho da Suavidade/Flexibilidade' },
        { palavra: 'JUDOCA', resposta: 'Aquele que pratica o JUDÔ' },
        { palavra: 'JUDOGUI', resposta: 'Roupa para a prática do JUDÔ' },
        { palavra: 'KAESHI-WAZA', resposta: 'Técnicas de contragolpes' },
        { palavra: 'KAKÊ', resposta: 'Execução, finalização' },
        { palavra: 'KAMI', resposta: 'Acima' },
        { palavra: 'KATAME', resposta: 'Controle' },
        { palavra: 'KENKA-YOTSU', resposta: 'Pegada contrária' },
        { palavra: 'KESA', resposta: 'Ângulo' },
        { palavra: 'KIAI', resposta: 'União do espírito, grito de competição' },
        { palavra: 'KO', resposta: 'Pequeno' },
        { palavra: 'KODOKAN', resposta: 'Escola onde se estuda o caminho' },
        { palavra: 'KÔ-HAI', resposta: 'Colega menos graduado' },
        { palavra: 'KON-BAN-WA', resposta: 'Boa Noite' },
        { palavra: 'KON-NITI-WA', resposta: 'Boa tarde' },
        { palavra: 'KOSHI', resposta: 'Quadril' },
        { palavra: 'KUMI-KATA', resposta: 'Maneira de segurar, pegada' },
        { palavra: 'KUZUSHI', resposta: 'Desequilíbrio' },
        { palavra: 'KYOTSUKE', resposta: 'Atenção' },
        { palavra: 'MATÊ', resposta: 'Parar' },
        { palavra: 'MIGUI', resposta: 'Direita' },
        { palavra: 'MIGUI-JIGÔ-TAI', resposta: 'Posição de defesa direita' },
        { palavra: 'MIGUI-KUMI', resposta: 'Pegada de direita' },
        { palavra: 'MIGUI-SHIZENTAI', resposta: 'Posição natural direita' },
        { palavra: 'MOKUSSÔ', resposta: 'Meditação' },
        { palavra: 'MORO-TE', resposta: 'Com as duas mãos' },
        { palavra: 'NAGUE-AI', resposta: 'Treinamento de projeção' },
        { palavra: 'Ô', resposta: 'Grande' },
        { palavra: 'OBI', resposta: 'Faixa' },
        { palavra: 'OHAYÔ-GOZAIMASSU', resposta: 'Bom dia' },
        { palavra: 'ONEGAI-SHIMASSU', resposta: 'Por favor' },
        { palavra: 'OSSAE-KOMI', resposta: 'Imobilização' },
        { palavra: 'OYASUMI-NASSAI', resposta: 'Boa noite (despedida)' },
        { palavra: 'RANDORI', resposta: 'Treinamento livre' },
        { palavra: 'REI', resposta: 'Cumprimento ou saudação' },
        { palavra: 'REI-HÔ', resposta: 'Formas de cumprimento/saudação' },
        { palavra: 'RENRAKU-HENKA-WAZA', resposta: 'Técnicas em sequência' },
        { palavra: 'RITSU-I', resposta: 'Posição em pé' },
        { palavra: 'RITSU-REI', resposta: 'Saudação em pé' },
        { palavra: 'SAYÔNARA', resposta: 'Até logo' },
        { palavra: 'SEI-ZÁ', resposta: 'Posição ajoelhado' },
        { palavra: 'SEMPAI', resposta: 'Colega mais graduado' },
        { palavra: 'SENSEI', resposta: 'Professor' },
        { palavra: 'SHIAI', resposta: 'Competição' },
        { palavra: 'SHIAI-GUEIKÔ', resposta: 'Treinamento de luta' },
        { palavra: 'SHIAI-JÔ', resposta: 'Área de competição' },
        { palavra: 'SHIDÔ', resposta: 'Penalidade = Cartão Amarelo' },
        { palavra: 'SHI-HAN', resposta: 'Mestre' },
        { palavra: 'SHINTAI', resposta: 'Formas de movimentação' },
        { palavra: 'SHISSEI', resposta: 'Postura' },
        { palavra: 'SHITABAKI OU ZUBON', resposta: 'Calça, parte inferior' },
        { palavra: 'SHIZEN-HONTAI', resposta: 'Posição natural' },
        { palavra: 'SHIZEN-TAI', resposta: 'Posição natural' },
        { palavra: 'SONO-MAMA', resposta: 'Parar do jeito que está' },
        { palavra: 'SOREMADÊ', resposta: 'Terminar, acabar' },
        { palavra: 'SURI-ASHI', resposta: 'Passo arrastado (sem tirar os pés do chão)' },
        { palavra: 'TAIKAI', resposta: 'Campeonato' },
        { palavra: 'TAI-SABAKI', resposta: 'Movimento de esquiva' },
        { palavra: 'TATÂMI', resposta: 'Acolchoado próprio para o JUDÔ' },
        { palavra: 'TATE', resposta: 'Levantar' },
        { palavra: 'TÊ', resposta: 'Mão, braço' },
        { palavra: 'TÊ-UKEMI', resposta: 'Treinamento de batida braço' },
        { palavra: 'TOKETÁ', resposta: 'Imobilização desfeita' },
        { palavra: 'TORIKESHI', resposta: 'Anulação da pontuação' },
        { palavra: 'TSUGUI-ASHI', resposta: 'Passo seguido' },
        { palavra: 'TSUKURI', resposta: 'Preparo do golpe' },
        { palavra: 'UKEMI', resposta: 'Amortecimento de queda ou queda' },
        { palavra: 'USHIRO', resposta: 'Atrás' },
        { palavra: 'USHIRÔ-UKEMI', resposta: 'Queda para trás' },
        { palavra: 'WAGUI', resposta: 'Casaco, parte superior do kimono' },
        { palavra: 'WAZA', resposta: 'Técnica' },
        { palavra: 'WAZA-ARI', resposta: 'Dez pontos' },
        { palavra: 'YOKO', resposta: 'Lado' },
        { palavra: 'YOKO-UKEMI', resposta: 'Queda para o lado' },
        { palavra: 'YOSHI', resposta: 'Continuar' },
        { palavra: 'ZAI', resposta: 'Posição sentado' },
        { palavra: 'ZA-REI', resposta: 'Saudação ajoelhado' }
    ]
};

let grupoAtual = null;
let contador = 0;
let acertos = 0;
let palavrasGrupo = [];

// Remove acentos e normaliza texto
function normalizar(texto) {
    return texto
        .normalize('NFD')
        .replace(/[̀-ͯ]/g, '')
        .toLowerCase()
        .trim();
}

function iniciarQuiz(grupo) {
    grupoAtual = grupo;
    palavrasGrupo = palavrasPorGrupo[grupo] || [];
    if (!palavrasGrupo.length) {
        alert('Esse grupo ainda não foi definido');
        return;
    }
    contador = 0;
    acertos = 0;
    document.getElementById('quiz-container').style.display = 'block';
    document.getElementById('menu-container').style.display = 'none';
    mostrarPalavra();
}

function mostrarPalavra() {
    if (contador >= palavrasGrupo.length) {
        mostrarResultado();
        return;
    }
    const palavraAtual = palavrasGrupo[contador];
    document.getElementById('grupo-titulo').innerText = `Grupo ${grupoAtual}`;
    document.getElementById('palavra-pergunta').innerText = `O que é "${palavraAtual.palavra}"?`;
    document.getElementById('resposta').value = '';
    document.getElementById('contador').innerText = `${contador + 1} de ${palavrasGrupo.length}`;
    document.querySelector('.feedback').innerHTML = '';
}

function verificarResposta() {
    const userRaw = document.getElementById('resposta').value;
    const respostaUsuario = normalizar(userRaw);
    const palavraAtual = palavrasGrupo[contador];
    
    // Gera lista de respostas aceitas
    const rawList = palavraAtual.resposta.split(',');
    const aceitas = rawList.map(r => normalizar(r));

    // Verificação exata ou similaridade
    const match = stringSimilarity.findBestMatch(respostaUsuario, aceitas);
    const melhor = match.bestMatch;
    const threshold = 0.7;

    if (aceitas.includes(respostaUsuario) || melhor.rating >= threshold) {
        acertos++;
        document.querySelector('.feedback').innerHTML = `<p class=\"acerto\">Correto!</p>`;
    } else {
        document.querySelector('.feedback').innerHTML = `<p class=\"erro\">Errado! A resposta correta é "${palavraAtual.resposta}".</p>`;
    }

    contador++;
    setTimeout(mostrarPalavra, 1000);
}

function mostrarResultado() {
    document.getElementById('resultado').innerText = `Você acertou ${acertos} de ${palavrasGrupo.length}`;
    setTimeout(() => {
        document.getElementById('quiz-container').style.display = 'none';
        document.getElementById('menu-container').style.display = 'block';
    }, 3000);
}
